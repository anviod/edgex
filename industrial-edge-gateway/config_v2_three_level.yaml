version: "1.0"
server:
  port: 8080
storage:
  path: "./data/gateway.db"

# 采集通道 - 第一级 (一个通道对应一个采集驱动)
channels:
  # Modbus TCP 通道 1
  - id: "modbus-tcp-1"
    name: "Modbus TCP Channel 1"
    protocol: "modbus-tcp"
    enable: true
    config:
      url: "tcp://127.0.0.1:502"
      max_packet_size: 125
      group_threshold: 50
    # 设备列表 - 第二级 (该通道下的多个从机设备)
    devices:
      - id: "slave-1"
        name: "Slave Device 1"
        enable: true
        interval: 5s
        config:
          slave_id: 1
        # 点位列表 - 第三级
        points:
          - id: "dev1_temp"
            name: "Temperature"
            address: "40001"
            datatype: "int16"
            readwrite: "RW"
            scale: 0.1
            offset: 0
            unit: "°C"
          - id: "dev1_humidity"
            name: "Humidity"
            address: "40002"
            datatype: "int16"
            readwrite: "RW"
            scale: 0.1
            offset: 0
            unit: "%"
          - id: "dev1_pressure"
            name: "Pressure"
            address: "40003"
            datatype: "int16"
            readwrite: "RW"
            scale: 1.0
            offset: 0
            unit: "kPa"

      - id: "slave-2"
        name: "Slave Device 2"
        enable: true
        interval: 5s
        config:
          slave_id: 2
        points:
          - id: "dev2_temp"
            name: "Temperature"
            address: "40001"
            datatype: "int16"
            readwrite: "RW"
            scale: 0.1
            offset: 0
            unit: "°C"
          - id: "dev2_current"
            name: "Current"
            address: "40004"
            datatype: "float32"
            readwrite: "R"
            scale: 1.0
            offset: 0
            unit: "A"

  # Modbus TCP 通道 2
  - id: "modbus-tcp-2"
    name: "Modbus TCP Channel 2 (远程机房)"
    protocol: "modbus-tcp"
    enable: false
    config:
      url: "tcp://192.168.1.100:502"
      max_packet_size: 125
      group_threshold: 50
    devices:
      - id: "remote-slave-1"
        name: "Remote Slave 1"
        enable: true
        interval: 10s
        config:
          slave_id: 1
        points:
          - id: "remote_temp"
            name: "Remote Temperature"
            address: "40001"
            datatype: "int16"
            readwrite: "R"
            scale: 0.1
            offset: 0
            unit: "°C"

  # Modbus RTU 通道
  - id: "modbus-rtu-1"
    name: "Modbus RTU Channel (本地网关)"
    protocol: "modbus-rtu"
    enable: false
    config:
      port: "/dev/ttyUSB0"
      baudrate: 9600
      timeout: 5s
    devices:
      - id: "rtu-device-1"
        name: "RTU Device 1"
        enable: true
        interval: 2s
        config:
          slave_id: 1
        points:
          - id: "rtu_temp"
            name: "Temperature"
            address: "0"
            datatype: "int16"
            readwrite: "RW"
            scale: 0.1
            offset: 0
            unit: "°C"
