 BACnet 驱动采集测试与验收标准清单，覆盖：**设备扫描、对象发现、点位采集、写入控制、稳定性、兼容性**等核心能力。

---

## 一、设备发现（Device Discovery）必须达标

### 1️⃣ Who-Is / I-Am 发现能力

**达标要求：**

* 能广播 Who-Is
* 能正确解析 I-Am 报文
* 提取并存储以下字段：

  * `DeviceInstance`
  * `VendorID`
  * `VendorName`
  * `ModelName`
  * `MaxAPDU`
  * `SegmentationSupported`

**验收标准：**

* 同一网段内 100% 设备可被发现
* 重复广播不产生重复设备实例
* 断网重连后自动重新发现设备

---

## 二、对象列表发现（Object Discovery）必须达标

### 2️⃣ objectList 解析能力

**达标要求：**

* 能通过 `ReadProperty(Device, objectList)` 获取完整对象列表
* 支持分段传输（segmented response）
* 能识别对象类型与实例号（如 `analogInput, 1`）

**验收标准：**

* 所有设备对象完整获取（无丢失、无重复）
* 分段情况下不丢对象、不乱序

---

## 三、对象属性读取（Point Read）必须达标

### 3️⃣ 基础属性读取

**至少支持以下属性：**

| 对象类型     | 必须支持属性                                              |
| -------- | --------------------------------------------------- |
| AI/AO/AV | Present_Value, Units, Status_Flags                  |
| BI/BO/BV | Present_Value, Polarity, Status_Flags               |
| Device   | Object_Name, Vendor_Name, Model_Name, System_Status |

**验收标准：**

* 所有点位 Present_Value 读取成功率 ≥ 99%
* 单次采集延迟 ≤ 500ms（局域网场景）
* 非法点位读取不影响整体采集线程

---

## 四、点位写入控制（WriteProperty）必须达标

### 4️⃣ 写入能力

**达标要求：**

* 支持 `WriteProperty` 写入：

  * Analog Value
  * Binary Output
* 支持优先级写入（Priority 1~16）
* 支持释放写入（写 NULL）

**验收标准：**

* 写入后读取值一致
* 优先级机制正确生效
* 无权限写入时返回明确错误

---

## 五、COV 订阅（可选但强烈推荐）

### 5️⃣ Change of Value 订阅

**达标要求：**

* 支持 `SubscribeCOV`
* 支持订阅失败回退为轮询模式
* 支持订阅过期自动重订

**验收标准：**

* 变化事件实时上报，无轮询延迟
* 设备重启后可自动恢复订阅

---

## 六、异常处理与健壮性必须达标

### 6️⃣ 错误与异常场景处理

必须覆盖以下场景：

* 设备断电 / 掉线
* 网络抖动 / 超时
* 响应报文格式错误
* 单点读取异常

**验收标准：**

* 单设备异常不影响其他设备采集
* 超时可自动重试，重试次数可配置
* 错误有完整日志（含 DeviceID、ObjectID、Property、错误码）

---

## 七、性能与稳定性必须达标

### 7️⃣ 性能指标

**推荐基线指标（可根据项目规模调整）：**

* 单进程支持 ≥ 256 设备
* 每设备 ≥ 500 点位
* 点位采集周期：5~30 秒可配置
* CPU 占用稳定，无内存泄漏（72小时压测）

---

## 八、配置与自动化能力必须达标

### 8️⃣ 自动注册与建模

**达标要求：**

* 新发现设备自动注册
* 自动生成点位模型（AutoGeneratePoints）
* 支持模型持久化（JSON / DB）

**验收标准：**

* 无需人工配置即可完成基础采集
* 重启后模型自动恢复

---

## 九、测试用例结构建议

```text
1. 设备发现测试
   - Who-Is / I-Am 发现
   - 重复发现处理
   - 断网重连恢复

2. 对象发现测试
   - objectList 读取
   - 分段传输支持
   - 大对象列表完整性

3. 点位读取测试
   - AI/BI/AV/BV 读取
   - 非法点位容错
   - 高并发读取稳定性

4. 点位写入测试
   - 普通写入
   - 优先级写入
   - 写入回读一致性

5. COV 订阅测试（如支持）
   - 正常订阅
   - 断线重订
   - 回退轮询机制

6. 稳定性测试
   - 长时间运行（72h）
   - 网络抖动
   - 设备异常恢复

7. 性能压测
   - 多设备、多点位、高频采集
   - CPU / 内存 / 延迟统计
```

---

## 十、需要“项目验收级”表格模板

生成一份：

* ✅ BACnet 驱动功能验收表（Markdown）
* ✅ 测试用例文档模板
* ✅ Go 驱动自测 checklist
* ✅ 自动化测试用例结构（基于现在的 BACnet 框架）

。
