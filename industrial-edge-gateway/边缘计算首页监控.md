
# 首页设计文档（嵌入式局域网边缘计算系统，按通道版）

## 一、设计目标

1. **按通道可视化**：南向采集、北向上报、规则执行和动作触发均按通道展示，方便运维和快速定位异常。
2. **嵌入式适配**：页面轻量、刷新可控，支持低资源嵌入式设备。
3. **异常高亮与告警**：通道异常、动作失败、规则异常统一高亮展示。
4. **快速跳转管理**：点击通道、规则、动作等可直接跳转到详细管理页面。
5. **硬件信息展示**：嵌入式设备基本信息和健康状态可见。

---

## 二、首页布局设计

首页分为五大区域：

1. **顶部导航栏**

   * 系统名称、当前设备/节点、刷新按钮、用户操作菜单
   * 切换局域网内设备（如果有多个边缘节点）

2. **通道总览区**

   * **南向采集通道卡片**

     * 显示字段：

       | 字段     | 描述                        |
       | ------ | ------------------------- |
       | 通道名称   | 用户自定义名称                   |
       | 协议类型   | Modbus/BACnet/OPC UA/MQTT |
       | 在线设备数  | 采集通道下在线设备数量               |
       | 离线设备数  | 离线设备数量                    |
       | 最新采集时间 | 最新数据时间戳                   |
       | 数据质量统计 | 正常/异常比例                   |
       | 数据吞吐量  | 数据条数/秒                    |
       | 异常事件数  | 最近 N 条异常记录数量              |
     * **交互**：

       * 点击通道名称 → 通道详细页（设备列表 + 历史数据趋势）
       * 筛选通道：协议类型 / 状态 / 异常事件
       * 通道启停按钮
   * **北向上报通道卡片**

     * 显示字段：

       | 字段     | 描述                         |
       | ------ | -------------------------- |
       | 通道名称   | 用户自定义名称                    |
       | 输出方式   | MQTT / WebSocket / 局域网HTTP |
       | 成功次数   | 已发送成功消息数量                  |
       | 失败次数   | 消息发送失败数量                   |
       | 最近上报时间 | 最近一次上报时间                   |
       | 消息队列长度 | 待发送/重发队列长度                 |
       | 重试次数   | 自动重试次数                     |
     * **交互**：

       * 点击通道 → 输出动作详情页
       * 通道启停、修改输出方式或重试策略

3. **规则执行与动作监控区**

   * 按通道统计规则执行状态

     * 规则总数 / 启用规则数 / 成功执行次数 / 失败次数 / 平均耗时
   * 动作触发情况统计（北向上报 / 南向控制 / 本地存储）
   * 异常高亮显示：规则失败、动作失败

4. **嵌入式硬件信息区**

   * CPU 使用率、内存使用率、磁盘使用率
   * 网络状态：局域网 IP、吞吐量
   * 温度 / 电压 / 运行时间

5. **异常与告警区**

   * 高亮显示通道异常、规则失败、动作失败
   * 支持快速跳转至异常详情页
   * 显示重复告警抑制信息（Debounce）

---

## 三、交互设计

1. **通道卡片点击行为**

   * 跳转到通道详情页面
   * 显示设备列表、点位、历史采集/上报数据趋势图

2. **筛选与搜索**

   * 支持协议类型、在线状态、异常事件、通道名称筛选
   * 可搜索设备 ID / 名称 / 点位

3. **动态刷新策略**

   * 南向采集 / 北向上报 / 规则执行 / 本地动作状态支持独立刷新
   * 可设置刷新间隔：低频（10秒）、高频（1~2秒）
   * 数据卡片缓存最近 N 条记录，减轻嵌入式设备内存压力

4. **异常高亮与告警**

   * 异常指标红色高亮，正常绿色，离线灰色
   * 支持规则触发条件组合：满足条件或只要有一条满足即可触发动作

5. **硬件信息监控**

   * 点击硬件卡片可展开详细信息
   * 支持嵌入式资源阈值告警（如 CPU>80%，内存>70%）

---

## 四、数据结构与接口设计

1. **通道数据结构（简化示例）**

```json
{
  "channelID": "ch1",
  "name": "Modbus Channel 1",
  "type": "南向采集",
  "protocol": "Modbus",
  "devicesOnline": 8,
  "devicesOffline": 2,
  "latestTimestamp": "2026-01-26T06:00:00Z",
  "dataQuality": { "normal": 90, "abnormal": 10 },
  "throughput": 25,
  "exceptions": 3
}
```

2. **北向上报通道结构**

```json
{
  "channelID": "out1",
  "name": "MQTT Channel 1",
  "type": "北向上报",
  "outputType": "MQTT",
  "successCount": 500,
  "failCount": 3,
  "lastTimestamp": "2026-01-26T06:02:00Z",
  "queueLength": 5,
  "retryCount": 1
}
```

3. **规则状态结构**

```json
{
  "ruleID": "rule1",
  "name": "温度超限",
  "channelID": "ch1",
  "status": "启用",
  "successCount": 100,
  "failCount": 2,
  "averageExecutionTimeMs": 5
}
```

---

## 五、首页监控指标验收标准

### 1. 通道指标

| 指标     | 验收条件                        |
| ------ | --------------------------- |
| 通道总览显示 | 所有南向采集和北向上报通道显示，且字段完整       |
| 通道状态显示 | 在线 / 离线 / 异常状态高亮显示正确        |
| 数据刷新   | 卡片刷新间隔 ≤ 配置间隔（1~10秒），最新数据正确 |
| 异常跳转   | 点击通道跳转至详情页，数据正确显示           |

### 2. 规则与动作

| 指标     | 验收条件                          |
| ------ | ----------------------------- |
| 规则执行状态 | 每条规则状态与通道关联正确，执行次数/失败次数准确     |
| 动作触发   | 符合规则触发条件的动作正确执行（本地 / 南向 / 北向） |
| 失败处理   | 输出失败可缓存并重试，失败统计显示正确           |

### 3. 硬件信息

| 指标        | 验收条件                |
| --------- | ------------------- |
| CPU/内存/磁盘 | 实时监控准确显示，值与系统真实使用一致 |
| 网络信息      | 局域网 IP、吞吐量显示准确      |
| 电源/温度     | 硬件状态值与设备接口一致        |

### 4. 性能与资源

| 指标   | 验收条件                   |
| ---- | ---------------------- |
| 页面响应 | 单次刷新 ≤ 500ms（嵌入式轻量级硬件） |
| 内存占用 | 首页刷新占用 ≤ 50MB 内存       |
| 数据缓存 | 最近 N 条数据正确显示，不丢失       |

### 5. 高可用与异常处理

| 指标   | 验收条件              |
| ---- | ----------------- |
| 异常高亮 | 异常通道、规则、动作高亮显示准确  |
| 异常跳转 | 点击异常快速跳转到详细页      |
| 重试策略 | 输出动作失败可重试，缓存状态可查看 |
